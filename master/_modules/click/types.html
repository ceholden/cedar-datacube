

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>click.types &mdash; ardzilla 0+untagged.50.gd61b51c documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ardzilla
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.50.gd61b51c
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credentials.html">Credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../convert.html">Pre-ARD to ARD Conversion</a></li>
</ul>
<p class="caption"><span class="caption-text">Help and Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev.html">Developer Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ardzilla</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>click.types</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for click.types</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">stat</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">._compat</span> <span class="k">import</span> <span class="n">open_stream</span><span class="p">,</span> <span class="n">text_type</span><span class="p">,</span> <span class="n">filename_to_ui</span><span class="p">,</span> \
    <span class="n">get_filesystem_encoding</span><span class="p">,</span> <span class="n">get_streerror</span><span class="p">,</span> <span class="n">_get_argv_encoding</span><span class="p">,</span> <span class="n">PY2</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="k">import</span> <span class="n">BadParameter</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">safecall</span><span class="p">,</span> <span class="n">LazyFile</span>


<span class="k">class</span> <span class="nc">ParamType</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper for converting values through types.  The following is</span>
<span class="sd">    necessary for a valid type:</span>

<span class="sd">    *   it needs a name</span>
<span class="sd">    *   it needs to pass through None unchanged</span>
<span class="sd">    *   it needs to convert from a string</span>
<span class="sd">    *   it needs to convert its result type through unchanged</span>
<span class="sd">        (eg: needs to be idempotent)</span>
<span class="sd">    *   it needs to be able to deal with param and context being `None`.</span>
<span class="sd">        This can be the case when the object is used with prompt</span>
<span class="sd">        inputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_composite</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">#: the descriptive name of this type</span>
    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#: if a list of this type is expected and the value is pulled from a</span>
    <span class="c1">#: string environment variable, this is what splits it up.  `None`</span>
    <span class="c1">#: means any whitespace.  For all parameters the general rule is that</span>
    <span class="c1">#: whitespace splits them up.  The exception are paths and files which</span>
    <span class="c1">#: are split by ``os.path.pathsep`` by default (&quot;:&quot; on Unix and &quot;;&quot; on</span>
    <span class="c1">#: Windows).</span>
    <span class="n">envvar_list_splitter</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_metavar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the metavar default for this param if it provides one.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_missing_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Optionally might return extra information about a missing</span>
<span class="sd">        parameter.</span>

<span class="sd">        .. versionadded:: 2.0</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Converts the value.  This is not invoked for values that are</span>
<span class="sd">        `None` (the missing value).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">split_envvar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rv</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Given a value from an environment variable this splits it up</span>
<span class="sd">        into small chunks depending on the defined envvar list splitter.</span>

<span class="sd">        If the splitter is set to `None`, which means that whitespace splits,</span>
<span class="sd">        then leading and trailing whitespace is ignored.  Otherwise, leading</span>
<span class="sd">        and trailing splitters usually lead to empty items being included.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">rv</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">envvar_list_splitter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper method to fail with an invalid value message.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">BadParameter</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CompositeParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">is_composite</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">FuncParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">text_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">UnicodeError</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">UnprocessedParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;UNPROCESSED&#39;</span>


<span class="k">class</span> <span class="nc">StringParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">_get_argv_encoding</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">UnicodeError</span><span class="p">:</span>
                <span class="n">fs_enc</span> <span class="o">=</span> <span class="n">get_filesystem_encoding</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">fs_enc</span> <span class="o">!=</span> <span class="n">enc</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">fs_enc</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">UnicodeError</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;STRING&#39;</span>


<span class="k">class</span> <span class="nc">Choice</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The choice type allows a value to be checked against a fixed set</span>
<span class="sd">    of supported values. All of these values have to be strings.</span>

<span class="sd">    You should only pass a list or tuple of choices. Other iterables</span>
<span class="sd">    (like generators) may lead to surprising results.</span>

<span class="sd">    See :ref:`choice-opts` for an example.</span>

<span class="sd">    :param case_sensitive: Set to false to make choices case</span>
<span class="sd">        insensitive. Defaults to true.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;choice&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">case_sensitive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">choices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span> <span class="o">=</span> <span class="n">case_sensitive</span>

    <span class="k">def</span> <span class="nf">get_metavar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_missing_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Choose from:</span><span class="se">\n\t</span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="s1">&#39;,</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="c1"># Exact match</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="c1"># Match through normalization and case sensitivity</span>
        <span class="c1"># first do token_normalize_func, then lowercase</span>
        <span class="c1"># preserve original `value` to produce an accurate message in</span>
        <span class="c1"># `self.fail`</span>
        <span class="n">normed_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">normed_choices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span>

        <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
           <span class="n">ctx</span><span class="o">.</span><span class="n">token_normalize_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">normed_value</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">token_normalize_func</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">normed_choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctx</span><span class="o">.</span><span class="n">token_normalize_func</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span> <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_sensitive</span><span class="p">:</span>
            <span class="n">normed_value</span> <span class="o">=</span> <span class="n">normed_value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">normed_choices</span> <span class="o">=</span> <span class="p">[</span><span class="n">choice</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">normed_choices</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">normed_value</span> <span class="ow">in</span> <span class="n">normed_choices</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">normed_value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;invalid choice: </span><span class="si">%s</span><span class="s1">. (choose from </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">)),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Choice(</span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">DateTime</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The DateTime type converts date strings into `datetime` objects.</span>

<span class="sd">    The format strings which are checked are configurable, but default to some</span>
<span class="sd">    common (non-timezone aware) ISO 8601 formats.</span>

<span class="sd">    When specifying *DateTime* formats, you should only pass a list or a tuple.</span>
<span class="sd">    Other iterables, like generators, may lead to surprising results.</span>

<span class="sd">    The format strings are processed using ``datetime.strptime``, and this</span>
<span class="sd">    consequently defines the format strings which are allowed.</span>

<span class="sd">    Parsing is tried using each format, in order, and the first format which</span>
<span class="sd">    parses successfully is used.</span>

<span class="sd">    :param formats: A list or tuple of date format strings, in the order in</span>
<span class="sd">                    which they should be tried. Defaults to</span>
<span class="sd">                    ``&#39;%Y-%m-%d&#39;``, ``&#39;%Y-%m-%dT%H:%M:%S&#39;``,</span>
<span class="sd">                    ``&#39;%Y-%m-%d %H:%M:%S&#39;``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;datetime&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formats</span> <span class="o">=</span> <span class="n">formats</span> <span class="ow">or</span> <span class="p">[</span>
            <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_metavar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formats</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_try_to_convert_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="c1"># Exact match</span>
        <span class="k">for</span> <span class="nb">format</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">formats</span><span class="p">:</span>
            <span class="n">dtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_convert_date</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dtime</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">dtime</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span>
            <span class="s1">&#39;invalid datetime format: </span><span class="si">{}</span><span class="s1">. (choose from </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">value</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formats</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;DateTime&#39;</span>


<span class="k">class</span> <span class="nc">IntParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;integer&#39;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">UnicodeError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a valid integer&#39;</span> <span class="o">%</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;INT&#39;</span>


<span class="k">class</span> <span class="nc">IntRange</span><span class="p">(</span><span class="n">IntParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A parameter that works similar to :data:`click.INT` but restricts</span>
<span class="sd">    the value to fit into a range.  The default behavior is to fail if the</span>
<span class="sd">    value falls outside the range, but it can also be silently clamped</span>
<span class="sd">    between the two edges.</span>

<span class="sd">    See :ref:`ranges` for an example.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;integer range&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="n">clamp</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">IntParamType</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">or</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is bigger than the maximum valid value &#39;</span>
                          <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is smaller than the minimum valid value &#39;</span>
                          <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not in the valid range of </span><span class="si">%s</span><span class="s1"> to </span><span class="si">%s</span><span class="s1">.&#39;</span>
                          <span class="o">%</span> <span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;IntRange(</span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FloatParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;float&#39;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">UnicodeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a valid floating point value&#39;</span> <span class="o">%</span>
                      <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;FLOAT&#39;</span>


<span class="k">class</span> <span class="nc">FloatRange</span><span class="p">(</span><span class="n">FloatParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A parameter that works similar to :data:`click.FLOAT` but restricts</span>
<span class="sd">    the value to fit into a range.  The default behavior is to fail if the</span>
<span class="sd">    value falls outside the range, but it can also be silently clamped</span>
<span class="sd">    between the two edges.</span>

<span class="sd">    See :ref:`ranges` for an example.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;float range&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clamp</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span> <span class="o">=</span> <span class="n">clamp</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">FloatParamType</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">or</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is bigger than the maximum valid value &#39;</span>
                          <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is smaller than the minimum valid value &#39;</span>
                          <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not in the valid range of </span><span class="si">%s</span><span class="s1"> to </span><span class="si">%s</span><span class="s1">.&#39;</span>
                          <span class="o">%</span> <span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;FloatRange(</span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">BoolParamType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;boolean&#39;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a valid boolean&#39;</span> <span class="o">%</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;BOOL&#39;</span>


<span class="k">class</span> <span class="nc">UUIDParameterType</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;uuid&#39;</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">uuid</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">PY2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">text_type</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">UnicodeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a valid UUID value&#39;</span> <span class="o">%</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;UUID&#39;</span>


<span class="k">class</span> <span class="nc">File</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Declares a parameter to be a file for reading or writing.  The file</span>
<span class="sd">    is automatically closed once the context tears down (after the command</span>
<span class="sd">    finished working).</span>

<span class="sd">    Files can be opened for reading or writing.  The special value ``-``</span>
<span class="sd">    indicates stdin or stdout depending on the mode.</span>

<span class="sd">    By default, the file is opened for reading text data, but it can also be</span>
<span class="sd">    opened in binary mode or for writing.  The encoding parameter can be used</span>
<span class="sd">    to force a specific encoding.</span>

<span class="sd">    The `lazy` flag controls if the file should be opened immediately or upon</span>
<span class="sd">    first IO. The default is to be non-lazy for standard input and output</span>
<span class="sd">    streams as well as files opened for reading, `lazy` otherwise. When opening a</span>
<span class="sd">    file lazily for reading, it is still opened temporarily for validation, but</span>
<span class="sd">    will not be held open until first IO. lazy is mainly useful when opening</span>
<span class="sd">    for writing to avoid creating the file until it is needed.</span>

<span class="sd">    Starting with Click 2.0, files can also be opened atomically in which</span>
<span class="sd">    case all writes go into a separate file in the same folder and upon</span>
<span class="sd">    completion the file will be moved over to the original location.  This</span>
<span class="sd">    is useful if a file regularly read by other users is modified.</span>

<span class="sd">    See :ref:`file-args` for more information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;filename&#39;</span>
    <span class="n">envvar_list_splitter</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">pathsep</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">atomic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lazy</span> <span class="o">=</span> <span class="n">lazy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomic</span> <span class="o">=</span> <span class="n">atomic</span>

    <span class="k">def</span> <span class="nf">resolve_lazy_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lazy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lazy</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="s1">&#39;w&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">value</span>

            <span class="n">lazy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_lazy_flag</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">lazy</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">LazyFile</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
                             <span class="n">atomic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">call_on_close</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">close_intelligently</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">f</span>

            <span class="n">f</span><span class="p">,</span> <span class="n">should_close</span> <span class="o">=</span> <span class="n">open_stream</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
                                          <span class="n">atomic</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic</span><span class="p">)</span>
            <span class="c1"># If a context is provided, we automatically close the file</span>
            <span class="c1"># at the end of the context execution (or flush out).  If a</span>
            <span class="c1"># context does not exist, it&#39;s the caller&#39;s responsibility to</span>
            <span class="c1"># properly close the file.  This for instance happens when the</span>
            <span class="c1"># type is used with prompts.</span>
            <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">should_close</span><span class="p">:</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">call_on_close</span><span class="p">(</span><span class="n">safecall</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">call_on_close</span><span class="p">(</span><span class="n">safecall</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">f</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;Could not open file: </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">filename_to_ui</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
                <span class="n">get_streerror</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Path</span><span class="p">(</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The path type is similar to the :class:`File` type but it performs</span>
<span class="sd">    different checks.  First of all, instead of returning an open file</span>
<span class="sd">    handle it returns just the filename.  Secondly, it can perform various</span>
<span class="sd">    basic checks about what the file or directory should be.</span>

<span class="sd">    .. versionchanged:: 6.0</span>
<span class="sd">       `allow_dash` was added.</span>

<span class="sd">    :param exists: if set to true, the file or directory needs to exist for</span>
<span class="sd">                   this value to be valid.  If this is not required and a</span>
<span class="sd">                   file does indeed not exist, then all further checks are</span>
<span class="sd">                   silently skipped.</span>
<span class="sd">    :param file_okay: controls if a file is a possible value.</span>
<span class="sd">    :param dir_okay: controls if a directory is a possible value.</span>
<span class="sd">    :param writable: if true, a writable check is performed.</span>
<span class="sd">    :param readable: if true, a readable check is performed.</span>
<span class="sd">    :param resolve_path: if this is true, then the path is fully resolved</span>
<span class="sd">                         before the value is passed onwards.  This means</span>
<span class="sd">                         that it&#39;s absolute and symlinks are resolved.  It</span>
<span class="sd">                         will not expand a tilde-prefix, as this is</span>
<span class="sd">                         supposed to be done by the shell only.</span>
<span class="sd">    :param allow_dash: If this is set to `True`, a single dash to indicate</span>
<span class="sd">                       standard streams is permitted.</span>
<span class="sd">    :param path_type: optionally a string type that should be used to</span>
<span class="sd">                      represent the path.  The default is `None` which</span>
<span class="sd">                      means the return value will be either bytes or</span>
<span class="sd">                      unicode depending on what makes most sense given the</span>
<span class="sd">                      input data Click deals with.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">envvar_list_splitter</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">pathsep</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exists</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">file_okay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dir_okay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">writable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">readable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">resolve_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">allow_dash</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exists</span> <span class="o">=</span> <span class="n">exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_okay</span> <span class="o">=</span> <span class="n">file_okay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_okay</span> <span class="o">=</span> <span class="n">dir_okay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writable</span> <span class="o">=</span> <span class="n">writable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readable</span> <span class="o">=</span> <span class="n">readable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolve_path</span> <span class="o">=</span> <span class="n">resolve_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_dash</span> <span class="o">=</span> <span class="n">allow_dash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">path_type</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_okay</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_okay</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span> <span class="o">=</span> <span class="s1">&#39;File&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_okay</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_okay</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;directory&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span> <span class="o">=</span> <span class="s1">&#39;Directory&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;path&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span> <span class="o">=</span> <span class="s1">&#39;Path&#39;</span>

    <span class="k">def</span> <span class="nf">coerce_path_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rv</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">text_type</span><span class="p">:</span>
                <span class="n">rv</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">get_filesystem_encoding</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rv</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">get_filesystem_encoding</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">rv</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">is_dash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_okay</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_dash</span> <span class="ow">and</span> <span class="n">rv</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dash</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_path</span><span class="p">:</span>
                <span class="n">rv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">st</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce_path_result</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot; does not exist.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span><span class="p">,</span>
                    <span class="n">filename_to_ui</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_okay</span> <span class="ow">and</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_ISREG</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">st_mode</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot; is a file.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span><span class="p">,</span>
                    <span class="n">filename_to_ui</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_okay</span> <span class="ow">and</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_ISDIR</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">st_mode</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot; is a directory.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span><span class="p">,</span>
                    <span class="n">filename_to_ui</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">W_OK</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot; is not writable.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span><span class="p">,</span>
                    <span class="n">filename_to_ui</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">readable</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">R_OK</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot; is not readable.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">path_type</span><span class="p">,</span>
                    <span class="n">filename_to_ui</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce_path_result</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Tuple</span><span class="p">(</span><span class="n">CompositeParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The default behavior of Click is to apply a type on a value directly.</span>
<span class="sd">    This works well in most cases, except for when `nargs` is set to a fixed</span>
<span class="sd">    count and different types should be used for different items.  In this</span>
<span class="sd">    case the :class:`Tuple` type can be used.  This type can only be used</span>
<span class="sd">    if `nargs` is set to a fixed number.</span>

<span class="sd">    For more information see :ref:`tuple-type`.</span>

<span class="sd">    This can be selected by using a Python tuple literal as a type.</span>

<span class="sd">    :param types: a list of types that should be used for the tuple items.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">convert_type</span><span class="p">(</span><span class="n">ty</span><span class="p">)</span> <span class="k">for</span> <span class="n">ty</span> <span class="ow">in</span> <span class="n">types</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ty</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ty</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;It would appear that nargs is set to conflict &#39;</span>
                            <span class="s1">&#39;with the composite type arity.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ty</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span> <span class="k">for</span> <span class="n">ty</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">convert_type</span><span class="p">(</span><span class="n">ty</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts a callable or python ty into the most appropriate param</span>
<span class="sd">    ty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">guessed_type</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">ty</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ty</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="n">guessed_type</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ty</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Tuple</span><span class="p">(</span><span class="n">ty</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ty</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ty</span>
    <span class="k">if</span> <span class="n">ty</span> <span class="ow">is</span> <span class="n">text_type</span> <span class="ow">or</span> <span class="n">ty</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">STRING</span>
    <span class="k">if</span> <span class="n">ty</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">INT</span>
    <span class="c1"># Booleans are only okay if not guessed.  This is done because for</span>
    <span class="c1"># flags the default value is actually a bit of a lie in that it</span>
    <span class="c1"># indicates which of the flags is the one we want.  See get_default()</span>
    <span class="c1"># for more information.</span>
    <span class="k">if</span> <span class="n">ty</span> <span class="ow">is</span> <span class="nb">bool</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">guessed_type</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">BOOL</span>
    <span class="k">if</span> <span class="n">ty</span> <span class="ow">is</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FLOAT</span>
    <span class="k">if</span> <span class="n">guessed_type</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">STRING</span>

    <span class="c1"># Catch a common mistake</span>
    <span class="k">if</span> <span class="n">__debug__</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">ty</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Attempted to use an uninstantiated &#39;</span>
                                     <span class="s1">&#39;parameter type (</span><span class="si">%s</span><span class="s1">).&#39;</span> <span class="o">%</span> <span class="n">ty</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">FuncParamType</span><span class="p">(</span><span class="n">ty</span><span class="p">)</span>


<span class="c1">#: A dummy parameter type that just does nothing.  From a user&#39;s</span>
<span class="c1">#: perspective this appears to just be the same as `STRING` but internally</span>
<span class="c1">#: no string conversion takes place.  This is necessary to achieve the</span>
<span class="c1">#: same bytes/unicode behavior on Python 2/3 in situations where you want</span>
<span class="c1">#: to not convert argument types.  This is usually useful when working</span>
<span class="c1">#: with file paths as they can appear in bytes and unicode.</span>
<span class="c1">#:</span>
<span class="c1">#: For path related uses the :class:`Path` type is a better choice but</span>
<span class="c1">#: there are situations where an unprocessed type is useful which is why</span>
<span class="c1">#: it is is provided.</span>
<span class="c1">#:</span>
<span class="c1">#: .. versionadded:: 4.0</span>
<span class="n">UNPROCESSED</span> <span class="o">=</span> <span class="n">UnprocessedParamType</span><span class="p">()</span>

<span class="c1">#: A unicode string parameter type which is the implicit default.  This</span>
<span class="c1">#: can also be selected by using ``str`` as type.</span>
<span class="n">STRING</span> <span class="o">=</span> <span class="n">StringParamType</span><span class="p">()</span>

<span class="c1">#: An integer parameter.  This can also be selected by using ``int`` as</span>
<span class="c1">#: type.</span>
<span class="n">INT</span> <span class="o">=</span> <span class="n">IntParamType</span><span class="p">()</span>

<span class="c1">#: A floating point value parameter.  This can also be selected by using</span>
<span class="c1">#: ``float`` as type.</span>
<span class="n">FLOAT</span> <span class="o">=</span> <span class="n">FloatParamType</span><span class="p">()</span>

<span class="c1">#: A boolean parameter.  This is the default for boolean flags.  This can</span>
<span class="c1">#: also be selected by using ``bool`` as a type.</span>
<span class="n">BOOL</span> <span class="o">=</span> <span class="n">BoolParamType</span><span class="p">()</span>

<span class="c1">#: A UUID parameter.</span>
<span class="n">UUID</span> <span class="o">=</span> <span class="n">UUIDParameterType</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Chris Holden

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>